/*! CSS3 attr() Polyfill - v0.0.2 - 2013-08-16
 * 
 * Copyright (c) 2013 Fabrice Weinberg
 */
!function(a){function b(){}function c(a){this.doc=a}function d(a,b,c,d){this.observerList=a,this.mutationObserver=b,this.styleGenerator=c,this.doc=d}b.prototype={hyphenToCamelCase:function(a){if(-1===a.indexOf("-"))return a;"-"===a.charAt(0)&&(a=a.substr(1));for(var b=a.split("-"),c="",d=b.length,e=1;d>e;e++){var f=b[e];c+=f[0].toUpperCase()+f.substr(1).toLowerCase()}return b[0].toLowerCase()+c},parseParam:function(a){var b=a.indexOf(" "),c=a.indexOf(","),d="",e="",f="";return-1!==b&&(d=a.substr(0,b).trim(),e=-1!==c?a.substr(b+1,c-(b+1)).trim():a.substr(b+1).trim()),-1!==c&&(f=a.substr(c+1).trim()),""===d&&(d=a),[d,e,f]},parse:function(a,b){if(!a||!b)return null;var c,d,e=[],f=[],g=0,h=0;if(-1!==b.indexOf("(")&&b.split("(").length===b.split(")").length){for(;-1!==(h=b.indexOf("attr(",g));){c=h+5,d=b.indexOf(")",c),0!==h-g&&e.push('"'+b.substr(g,h-g)+'"');var i=this.parseParam(b.substr(c,d-c));if(""===i[0])return null;e.push('(n.hasAttribute("'+i[0]+'") ? (n.getAttribute("'+i[0]+'") + "'+i[1]+'") : "'+i[2]+'" + "'+i[1]+'")'),f.push(i[0]),g=++d}if(g>0)return e.push('"'+b.substr(g)+'"'),{func:new Function("n","return "+e.join("+")),attr:f,cssProp:this.hyphenToCamelCase(a)}}return null}};var e=function(a){function b(){}var c=[].push,d=/\s*(.*?)\s*{([^}]*)}/g,e=/\s*(.*?)\s*:\s*([^;]*?);/g;return b.prototype={parse:function(b){if(void 0===b)return{};b=b.replace(/(?:\r|\n)/g,"").replace(/\/\*.+?\*\//g,"").toLowerCase();for(var f,g,h={};null!==(f=d.exec(b));)for(var i=f[1],j=f[2];null!==(g=e.exec(j));){var k=a.parse(g[1],g[2]);if(null!==k&&"content"!==k.cssProp){var l=h[i]||{attr:{},filter:[]};c.apply(l.filter,k.attr),k.attr.forEach(function(a){l.attr[a]=l.attr[a]||[],l.attr[a].push(k)}),h[i]=l}}return h}},b}(new b);c.prototype={resolveFuncList:function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];b[e.cssProp]=e.func(a)}},generate:function(a){var b=[];for(var c in a)for(var d=this.doc.querySelectorAll(c),e=a[c],f=0;f<d.length;f++){var g=d[f],h={},i={node:g,styles:h};for(var j in e.attr){var k=e.attr[j];this.resolveFuncList(g,h,k)}b.push(i)}return b},apply:function(a){for(var b=0;b<a.length;b++){var c=a[b],d=c.node,e=c.styles;for(var f in e)d.style[f]=e[f]}}},d.prototype={remove:function(){this.observerList.forEach(function(a){a.disconnect()})},add:function(a,b,c){var d=this.styleGenerator,e=new this.mutationObserver(function(c){for(var e={},f=[{node:a,styles:e}],g=0;g<c.length;g++){var h=c[g],i=h.attributeName;a.getAttribute(i)!==h.oldValue&&d.resolveFuncList(a,e,b[i])}d.apply(f)});return e.observe(a,{attributes:!0,attributeOldValue:!0,attributeFilter:c}),e},attach:function(a){for(var b in a)for(var c=this.doc.querySelectorAll(b),d=a[b],e=0;e<c.length;e++){var f=c[e];this.observerList.push(this.add(f,d.attr,d.filter))}}},a.cssattr=function(a,b,c){return{parse:function(b){return this.cssAst=a.parse(b),this},show:function(){return b.apply(b.generate(this.cssAst)),this},observe:function(){return c.attach(this.cssAst),this},unobserve:function(){return c.remove(),this}}}(new e,new c(document),new d([],MutationObserver||WebKitMutationObserver,new c(document),document))}(window);